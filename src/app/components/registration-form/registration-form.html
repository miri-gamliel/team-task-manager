<mat-card class="auth-card">
  <mat-card-header>
    <div class="header-content">
      <mat-icon class="logo-icon">task_alt</mat-icon>
      <mat-card-title>הרשמה למערכת</mat-card-title>
      <mat-card-subtitle>צור חשבון חדש לניהול המשימות שלך</mat-card-subtitle>
    </div>
  </mat-card-header>

  <mat-card-content>
    <form [formGroup]="userForm" (ngSubmit)="onSubmit()">
      
      <!-- הודעת שגיאה כללית -->
      @if (errorMessage()) {
        <div class="error-banner" @errorAnimation>
          <mat-icon>error_outline</mat-icon>
          <span>{{ errorMessage() }}</span>
        </div>
      }

      <!-- שדה שם -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>שם מלא</mat-label>
        <input 
          matInput 
          type="text" 
          formControlName="name" 
          placeholder="הזן את שמך המלא"
          autocomplete="name"
        >
        <mat-icon matPrefix>person</mat-icon>
        @if (userForm.get('name')?.invalid && userForm.get('name')?.touched) {
          <mat-error>{{ getErrorMessage('name') }}</mat-error>
        }
      </mat-form-field>

      <!-- שדה אימייל -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>אימייל</mat-label>
        <input 
          matInput 
          type="email" 
          formControlName="email" 
          placeholder="example@email.com"
          autocomplete="email"
        >
        <mat-icon matPrefix>email</mat-icon>
        @if (userForm.get('email')?.invalid && userForm.get('email')?.touched) {
          <mat-error>{{ getErrorMessage('email') }}</mat-error>
        }
      </mat-form-field>

      <!-- שדה סיסמה -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>סיסמה</mat-label>
        <input 
          matInput 
          [type]="hidePassword() ? 'password' : 'text'" 
          formControlName="password" 
          placeholder="הזן סיסמה (אותיות וספרות)"
          autocomplete="new-password"
        >
        <mat-icon matPrefix>lock</mat-icon>
        <button 
          mat-icon-button 
          matSuffix 
          type="button"
          (click)="togglePasswordVisibility()"
          [attr.aria-label]="'הצג סיסמה'"
          [attr.aria-pressed]="!hidePassword()"
        >
          <mat-icon>{{ hidePassword() ? 'visibility_off' : 'visibility' }}</mat-icon>
        </button>
        @if (userForm.get('password')?.invalid && userForm.get('password')?.touched) {
          <mat-error>{{ getErrorMessage('password') }}</mat-error>
        }
        <mat-hint>לפחות 6 תווים, כולל אותיות וספרות</mat-hint>
      </mat-form-field>

      <!-- כפתור שליחה -->
      <button 
        mat-raised-button 
        color="primary" 
        type="submit" 
        class="submit-button"
        [disabled]="userForm.invalid || isLoading()"
      >
        @if (isLoading()) {
          <mat-spinner diameter="20" class="spinner"></mat-spinner>
          <span>מבצע הרשמה...</span>
        } @else {
          <span>הירשם</span>
        }
      </button>
    </form>

    <!-- קישור להתחברות -->
    <div class="switch-auth">
      <span>כבר יש לך חשבון?</span>
      <a routerLink="/login" mat-button color="primary">התחבר כעת</a>
    </div>
  </mat-card-content>
</mat-card>